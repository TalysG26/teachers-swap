generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model StatusAulaDB {
  id    Int    @id @default(autoincrement())
  nome  String @unique
  aulas Aula[]
}

model StatusSolicitacaoDB {
  id           Int                    @id @default(autoincrement())
  nome         String                 @unique
  solicitacoes SolicitacaoReposicao[]
}

model Professor {
  id                    Int                    @id @default(autoincrement())
  nome                  String
  email                 String              @unique
  senha                 String
  formularioReposicao   Boolean                @default(false)
  criadoEm              DateTime               @default(now())
  aulas                 Aula[]                 @relation("AulasDoProfessor")
  solicitacoesRecebidas SolicitacaoReposicao[] @relation("SolicitacoesInteressados")
  solicitacoesEnviadas  SolicitacaoReposicao[] @relation("SolicitacoesOriginais")
}

model Aula {
  id           Int                    @id @default(autoincrement())
  data         DateTime
  horario      String
  observacao   String?
  professorId  Int
  criadoEm     DateTime               @default(now())
  statusId     Int
  professor    Professor              @relation("AulasDoProfessor", fields: [professorId], references: [id])
  status       StatusAulaDB           @relation(fields: [statusId], references: [id])
  solicitacoes SolicitacaoReposicao[]
}

model SolicitacaoReposicao {
  id                     Int                 @id @default(autoincrement())
  aulaId                 Int
  professorOriginalId    Int
  professorInteressadoId Int?
  dataSolicitacao        DateTime            @default(now())
  statusId               Int
  aula                   Aula                @relation(fields: [aulaId], references: [id])
  professorInteressado   Professor?          @relation("SolicitacoesInteressados", fields: [professorInteressadoId], references: [id])
  professorOriginal      Professor           @relation("SolicitacoesOriginais", fields: [professorOriginalId], references: [id])
  status                 StatusSolicitacaoDB @relation(fields: [statusId], references: [id])
}
